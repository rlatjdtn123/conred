<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
   
  
	<mapper namespace="com.hk.conred.Reserve">
		
		
																	<!-- menu일렬번호 #{}으로 바꿔야함 -->
		<insert id="insertReserve" parameterType="String">
			INSERT INTO CON_RESERVE VALUES(CON_RESERVE_SEQ.NEXTVAL,#{user_id},1,2,'16시 40분','Y','1원',SYSDATE)
		</insert>
		
		<select id="reserveList" parameterType="Map" resultType="ReserveDto">
			SELECT  rn, RESERVE_SEQ ,USER_ID ,cr.MENU_SEQ ,cr.STORE_SEQ ,RESERVE_TIME ,RESERVE_STATE ,RESERVE_PRICE ,
			RESERVE_SDATE ,RESERVE_EDATE ,RESERVE_REGDATE ,cm.MENU_NAME ,cs.STORE_NAME ,cs.STORE_ADDRESS  
			FROM
			    (SELECT  rownum AS rn,RESERVE_SEQ ,USER_ID ,MENU_SEQ ,STORE_SEQ ,RESERVE_TIME ,RESERVE_STATE ,RESERVE_PRICE ,RESERVE_SDATE ,RESERVE_EDATE ,RESERVE_REGDATE
			     FROM CON_RESERVE ) cr ,CON_MENU cm ,CON_STORE cs 
			WHERE cr.menu_seq=cm.MENU_SEQ AND cr.store_seq=cs.STORE_SEQ AND CEIL(rn/5)=#{pnum} AND USER_ID =#{user_id}
		</select>
		
		<select id="getReserve" parameterType="Int" resultType="ReserveDto">
			SELECT RESERVE_SEQ ,USER_ID ,MENU_SEQ ,STORE_SEQ ,RESERVE_TIME ,RESERVE_STATE ,RESERVE_PRICE ,RESERVE_REGDATE 
			FROM CON_RESERVE 
			WHERE RESERVE_SEQ =#{reserve_seq}
		</select>
		
		
	</mapper>
		  